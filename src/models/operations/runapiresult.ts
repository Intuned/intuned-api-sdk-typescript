/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v3";
import { remap as remap$ } from "../../lib/primitives.js";
import { safeParse } from "../../lib/schemas.js";
import { ClosedEnum } from "../../types/enums.js";
import { Result as SafeParseResult } from "../../types/fp.js";
import { SDKValidationError } from "../errors/sdkvalidationerror.js";

export type RunApiResultGlobals = {
  /**
   * Your workspace ID. [How to find it](/docs/guides/general/how-to-get-a-workspace-id)?
   */
  workspaceId?: string | undefined;
};

export type RunApiResultRequest = {
  /**
   * Your project name. It is the name you provide when creating a project.
   */
  projectName: string;
  /**
   * Run ID
   */
  runId: string;
};

/**
 * Status of the run execution
 */
export const RunApiResultStatus = {
  Pending: "pending",
  Started: "started",
  Completed: "completed",
  Canceled: "canceled",
  Failed: "failed",
} as const;
/**
 * Status of the run execution
 */
export type RunApiResultStatus = ClosedEnum<typeof RunApiResultStatus>;

export type ExtendedPayloads = {
  /**
   * The name of the API to be executed. This is the file path relative to the `api` folder inside your project.
   */
  api: string;
  runId?: string | undefined;
  /**
   * The parameters to be passed to the API.
   */
  parameters?: { [k: string]: any } | undefined;
};

/**
 * Optional error code for more specific error identification
 */
export const Code = {
  InternalServerError: "internal-server-error",
  ScriptProcessCrashed: "script-process-crashed",
  Unexpected: "unexpected",
  ScriptExecutionException: "script-execution-exception",
  ScriptNoValidOutputReceived: "script-no-valid-output-received",
  ResultTooBigError: "result-too-big-error",
  ScriptTimeout: "script-timeout",
  ScriptUnexpectedError: "script-unexpected-error",
  AuthCheckFailed: "auth-check-failed",
  AllAttemptsFailed: "all-attempts-failed",
  CheckAttemptsFailed: "check-attempts-failed",
  CreateAttemptsFailed: "create-attempts-failed",
  PostCreateCheckAttemptsFailed: "post-create-check-attempts-failed",
  ApiAttemptsFailed: "api-attempts-failed",
  OnepasswordIntegrationError: "onepassword-integration-error",
  JobRunTerminated: "job-run-terminated",
} as const;
/**
 * Optional error code for more specific error identification
 */
export type Code = ClosedEnum<typeof Code>;

export const Category = {
  Infrastructure: "infrastructure",
  Execution: "execution",
  Auth: "auth",
  User: "user",
  Billing: "billing",
} as const;
export type Category = ClosedEnum<typeof Category>;

export type ErrorT = {
  /**
   * Error message describing the failure
   */
  message: string;
  /**
   * Optional error code for more specific error identification
   */
  code?: Code | undefined;
  category: Category;
  retirable?: boolean | undefined;
  /**
   * Optional URL to documentation for this error
   */
  docUrl?: string | undefined;
  /**
   * Optional correlation ID for tracing the error in logs
   */
  correlationId?: string | undefined;
  details?: any | undefined;
};

export const RunApiResultType = {
  AuthSessionValidateDependencyFailed:
    "auth-session-validate-dependency-failed",
  Terminated: "terminated",
  JobRunPaused: "job-run-paused",
  JobRunTerminated: "job-run-terminated",
  FailedToInitializeJobRun: "failed-to-initialize-job-run",
  ApiAccessDisabled: "api-access-disabled",
  CancelledUserAction: "cancelled-user-action",
} as const;
export type RunApiResultType = ClosedEnum<typeof RunApiResultType>;

export type Reason = {
  type: RunApiResultType;
  message: string;
  /**
   * Optional URL to documentation for this error
   */
  docUrl?: string | undefined;
  details?: any | undefined;
};

/**
 * Run result with status and output data.
 */
export type RunApiResultResponseBody = {
  /**
   * Unique identifier for the run, nanoId of 21 characters
   */
  runId: string;
  /**
   * Status of the run execution
   */
  status: RunApiResultStatus;
  /**
   * Output result of the run execution
   */
  result?: any | undefined;
  /**
   * Extended payloads from the run execution
   */
  extendedPayloads?: Array<ExtendedPayloads> | undefined;
  error?: ErrorT | undefined;
  /**
   * Error or reason message
   */
  message?: string | undefined;
  reason?: Reason | undefined;
};

/** @internal */
export type RunApiResultRequest$Outbound = {
  projectName: string;
  runId: string;
};

/** @internal */
export const RunApiResultRequest$outboundSchema: z.ZodType<
  RunApiResultRequest$Outbound,
  z.ZodTypeDef,
  RunApiResultRequest
> = z.object({
  projectName: z.string(),
  runId: z.string(),
});

export function runApiResultRequestToJSON(
  runApiResultRequest: RunApiResultRequest,
): string {
  return JSON.stringify(
    RunApiResultRequest$outboundSchema.parse(runApiResultRequest),
  );
}

/** @internal */
export const RunApiResultStatus$inboundSchema: z.ZodNativeEnum<
  typeof RunApiResultStatus
> = z.nativeEnum(RunApiResultStatus);

/** @internal */
export const ExtendedPayloads$inboundSchema: z.ZodType<
  ExtendedPayloads,
  z.ZodTypeDef,
  unknown
> = z.object({
  api: z.string(),
  runId: z.string().optional(),
  parameters: z.record(z.any()).optional(),
});

export function extendedPayloadsFromJSON(
  jsonString: string,
): SafeParseResult<ExtendedPayloads, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => ExtendedPayloads$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'ExtendedPayloads' from JSON`,
  );
}

/** @internal */
export const Code$inboundSchema: z.ZodNativeEnum<typeof Code> = z.nativeEnum(
  Code,
);

/** @internal */
export const Category$inboundSchema: z.ZodNativeEnum<typeof Category> = z
  .nativeEnum(Category);

/** @internal */
export const ErrorT$inboundSchema: z.ZodType<ErrorT, z.ZodTypeDef, unknown> = z
  .object({
    message: z.string(),
    code: Code$inboundSchema.optional(),
    category: Category$inboundSchema,
    retirable: z.boolean().default(false),
    doc_url: z.string().optional(),
    correlation_id: z.string().optional(),
    details: z.any().optional(),
  }).transform((v) => {
    return remap$(v, {
      "doc_url": "docUrl",
      "correlation_id": "correlationId",
    });
  });

export function errorFromJSON(
  jsonString: string,
): SafeParseResult<ErrorT, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => ErrorT$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'ErrorT' from JSON`,
  );
}

/** @internal */
export const RunApiResultType$inboundSchema: z.ZodNativeEnum<
  typeof RunApiResultType
> = z.nativeEnum(RunApiResultType);

/** @internal */
export const Reason$inboundSchema: z.ZodType<Reason, z.ZodTypeDef, unknown> = z
  .object({
    type: RunApiResultType$inboundSchema,
    message: z.string(),
    doc_url: z.string().optional(),
    details: z.any().optional(),
  }).transform((v) => {
    return remap$(v, {
      "doc_url": "docUrl",
    });
  });

export function reasonFromJSON(
  jsonString: string,
): SafeParseResult<Reason, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => Reason$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'Reason' from JSON`,
  );
}

/** @internal */
export const RunApiResultResponseBody$inboundSchema: z.ZodType<
  RunApiResultResponseBody,
  z.ZodTypeDef,
  unknown
> = z.object({
  runId: z.string(),
  status: RunApiResultStatus$inboundSchema,
  result: z.any().optional(),
  extendedPayloads: z.array(z.lazy(() => ExtendedPayloads$inboundSchema))
    .optional(),
  error: z.lazy(() => ErrorT$inboundSchema).optional(),
  message: z.string().optional(),
  reason: z.lazy(() => Reason$inboundSchema).optional(),
});

export function runApiResultResponseBodyFromJSON(
  jsonString: string,
): SafeParseResult<RunApiResultResponseBody, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => RunApiResultResponseBody$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'RunApiResultResponseBody' from JSON`,
  );
}
